---
title: "R Notebook"
output: html_notebook
---

```{r}
library(RMySQL)
library(DBI)

fpath = "./"
dbfile = "bird_strikes.db"
mydb <-  dbConnect(MySQL(), user = "root", password = '',
                 dbname = 'Practicum1', host = 'localhost', port = 3306)
```


# airlines
# aid: auto generate, code: NULL, airline: "Aircraft: Airline/Operator"
```{sql connection=mydb}
CREATE TABLE airlines (
  aid INT(6) UNSIGNED AUTO_INCREMENT,
  code INT UNSIGNED,
  airline VARCHAR(30) NOT NULL,
  PRIMARY KEY (aid)
)
```

# airports
# pid: auto generate, code: NULL, name: "Airport: Name", city: NULL, state: "Origin State", country: USA
```{sql connection=mydb}
CREATE TABLE airports (
  pid INT(6) UNSIGNED AUTO_INCREMENT,
  code INT UNSIGNED,
  name VARCHAR(30) NOT NULL,
  city VARCHAR(20),
  state VARCHAR(20),
  country VARCHAR(20),
  PRIMARY KEY (pid)
)
```

# incidents
# iid: "Record ID", date: "FlightDate" (truncate time), depPort: "pid" (from airports table), airline: "aid" (from airlines table), aircraft: "Aircraft: Make/Model", arrPort: "pid" (same as depPort), flightPhase: "When: Phase of flight" (takeoff, landing, inflight, unknown), impact: "Effect: Impact to flight"
```{sql connection=mydb}
CREATE TABLE incidents(
  iid INT(6) UNSIGNED, 
  date DATE, 
  depPort INT(6) UNSIGNED, 
  arrPort INT(6) UNSIGNED, 
  airline INT(6) UNSIGNED, 
  aircraft VARCHAR(20), 
  flightPhase VARCHAR(20),
  CONSTRAINT check_phase CHECK (flightPhase IN ('takeoff', 'landing', 'inflight', 'unknown')),
  impact VARCHAR(40),
  PRIMARY KEY (iid),
  FOREIGN KEY (depPort) REFERENCES airports(pid),
  FOREIGN KEY (arrPort) REFERENCES airports(pid),
  FOREIGN KEY (airline) REFERENCES airlines(aid)
)
```
